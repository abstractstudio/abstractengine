var $jscomp={scope:{},inherits:function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]},getGlobal:function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a}};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function c(a){var c=Object[a];c&&(Object[a]=function(a){b(a);return c(a)})}if(function(){if(!a||!Object.seal)return!1;try{var c=Object.seal({}),b=Object.seal({}),d=new a([[c,2],[b,3]]);if(2!=d.get(c)||3!=d.get(b))return!1;d.delete(c);d.set(b,4);return!d.has(c)&&4==d.get(b)}catch(h){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);c("freeze");c("preventExtensions");
c("seal");var e=0,f=function(a){this.id_=(e+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};f.prototype.set=function(a,c){b(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=c;return this};f.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};f.prototype.has=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};f.prototype.delete=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return f},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a($jscomp.makeIterator([[c,"s"]]));if("s"!=b.get(c)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var d=b.entries(),e=d.next();if(e.done||e.value[0]!=c||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(k){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var b=new WeakMap,c=function(a){this.data_={};this.head_=f();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};c.prototype.set=function(a,c){var b=d(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=c:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:c},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};c.prototype.delete=
function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};c.prototype.has=function(a){return!!d(this,a).entry};c.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};c.prototype.entries=function(){return e(this,function(a){return[a.key,
a.value]})};c.prototype.keys=function(){return e(this,function(a){return a.key})};c.prototype.values=function(){return e(this,function(a){return a.value})};c.prototype.forEach=function(a,c){for(var b=this.entries(),d;!(d=b.next()).done;)d=d.value,a.call(c,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var d=function(a,c){var d;d=c&&typeof c;"object"==d||"function"==d?b.has(c)?d=b.get(c):(d=""+ ++g,b.set(c,d)):d="p_"+c;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=
e[a];if(c!==c&&f.key!==f.key||c===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},e=function(a,c){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:c(b)};b=null}return{done:!0,value:void 0}})},f=function(){var a={};return a.previous=a.next=a.head=a},g=0;return c},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(a){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a($jscomp.makeIterator([c]));if(!b.has(c)||1!=b.size||b.add(c)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var e=b.entries(),f=e.next();if(f.done||f.value[0]!=c||f.value[1]!=c)return!1;f=e.next();return f.done||f.value[0]==c||4!=f.value[0].x||f.value[1]!=f.value[0]?!1:e.next().done}catch(g){return!1}}())return a;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};
b.prototype.values=function(){return this.map_.values()};b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6-impl","es3");var engine={EventManager:{}},EventManager=function(){this.eventListeners={}};EventManager.prototype.addEventListener=function(a,b){void 0===this.eventListeners[a]?this.eventListeners[a]=[b]:this.eventListeners[a].push(b)};
EventManager.prototype.removeEventListener=function(a,b){if(void 0!==this.eventListeners[a])return b=this.eventListeners[a].indexOf(b),this.eventListeners[a].splice(b,b+1)};EventManager.prototype.fireEvent=function(a,b){a=this.eventListeners[a];void 0!==a&&a.map(function(a){a(b)})};engine.Asset={};engine.AssetManager={};var IMAGE="image",AUDIO="audio",ANIMATION="animation",CREATED=0,LOADING=1,LOADED=2,FAILED=3,Asset=function(a,b,c,d){this.name=a;this.type=b;this.path=c;this.options=d;this.status=CREATED;this.content=null};
Asset.prototype.load=function(a){var b=this;this.status=LOADING;var c=function(){b.status=LOADED;a()},d=function(){b.status=FAILED;a()};this.type==IMAGE?(this.content=new Image,this.content.onload=c,this.content.onerror=d,this.content.isRenderable=!0):this.type==AUDIO?(this.content=new Audio,this.content.oncanplaythrough=c,this.content.onerror=d,this.content.isRenderable=!1):this.type==ANIMATION&&(this.content=new Animation,this.content.onload=c,this.content.onerror=d,this.content.isRenderable=!0);
this.content.name=this.name;this.content.type=this.type;for(var e in this.options)this.options.hasOwnProperty(e)&&(this.content[e]=this.options[e]);this.content.src=this.path};var AssetManager=function(){EventManager.call(this);this.jobs=[];this.map={};this.status=CREATED};$jscomp.inherits(AssetManager,EventManager);AssetManager.prototype.queue=function(a,b,c,d){this.jobs.push(new Asset(a,b,c,d))};
AssetManager.prototype.load=function(a){var b=this;0==this.jobs.length&&a();for(var c in this.jobs){var d=this.jobs[c];this.map[d.name]=d;d.load(function(){for(var c in b.jobs){if(b.jobs[c].status<=LOADING)return;b.status=Math.max(b.status,b.jobs[c].status)}b.jobs=[];a()})}};AssetManager.prototype.get=function(a){if(a in this.map)return this.map[a].content};engine.InputManager={};engine.KEY={};engine.BUTTON={};engine.MOUSE={};engine.IGNORE={};
var KEY=Object.freeze({CANCEL:3,HELP:6,BACK_SPACE:8,TAB:9,CLEAR:12,RETURN:13,ENTER:14,SHIFT:16,CONTROL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINTSCREEN:44,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,SEMICOLON:59,EQUALS:61,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,
NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SEPARATOR:108,SUBTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,F20:131,F21:132,F22:133,F23:134,F24:135,NUM_LOCK:144,SCROLL_LOCK:145,COMMA:188,PERIOD:190,SLASH:191,BACK_QUOTE:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,QUOTE:222,META:224}),BUTTON=Object.freeze({INITIAL:1,
REPEAT:2,PRESSED:3}),MOUSE=Object.freeze({LEFT:0,RIGHT:2}),IGNORE=new Set([37,39,38,40,32]),InputManager=function(a){var b=this;EventManager.call(this);this.engine=a;this.canvas=a.canvas;this.canvas.requestPointerLock=canvas.requestPointerLock||canvas.mozRequestPointerLock||canvas.webkitRequestPointerLock;this.canvas.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock;this.mouse={x:0,y:0};this.keyboard={};this._capturing=this._captured=!1;this.enabled=
!0;document.addEventListener("keydown",function(a){b.onKeyDown(a)});document.addEventListener("keyup",this.onKeyUp.bind(this));document.addEventListener("mousedown",this.onMouseDown.bind(this));document.addEventListener("mouseup",this.onMouseUp.bind(this));document.addEventListener("mousemove",this.onMouseMove.bind(this));this.enabled&&(this.canvas.addEventListener("mousedown",function(a){b._captured||b.capture()},!1),document.addEventListener("pointerlockchange",function(a){b._capturing?b._capturing=
!1:b.release(!0)},!1))};$jscomp.inherits(InputManager,EventManager);InputManager.prototype.capture=function(){this._captured||(this._capturing=!0,this.canvas.requestPointerLock(),this._captured=!0)};InputManager.prototype.release=function(a){this._captured&&(this._captured=!1)};InputManager.prototype.onKeyDown=function(a){void 0===this.keyboard[a.keyCode]&&(this.keyboard[a.keyCode]=BUTTON.PRESSED);IGNORE.hasOwnProperty(a.keyCode)&&a.preventDefault()};InputManager.prototype.onKeyUp=function(a){delete this.keyboard[a.keyCode]};
InputManager.prototype.onMouseDown=function(a){this.mouse[a.button]=BUTTON.PRESSED};InputManager.prototype.onMouseUp=function(a){delete this.mouse[a.button]};InputManager.prototype.onMouseMove=function(a){this._isMouseCaptured?(this.mouse.x+=a.movementX||0,this.mouse.y+=a.movementY||0):this._useMouseCapture||(this.mouse.x=a.clientX-(engine.canvas?engine.canvas.offsetLeft+document.body.scrollLeft:0),this.mouse.y=a.clientY-(engine.canvas?engine.canvas.offsetTop+document.body.scrollTop:0))};
$jscomp.global.Object.defineProperties(InputManager.prototype,{captured:{configurable:!0,enumerable:!0,get:function(){return this._captured}}});engine.Engine={};var EngineFramework=function(a){EventManager.call(this);this.canvas=a};$jscomp.inherits(EngineFramework,EventManager);var EngineMachine=function(a){EngineFramework.call(this,a);this.state=null;this.states={}};$jscomp.inherits(EngineMachine,EngineFramework);EngineMachine.prototype.connect=function(a,b,c){};var Engine=function(a){EngineFramework.call(this,a);this.assets=new AssetManager(this);this.input=new InputManager(this);this.setup()};$jscomp.inherits(Engine,EngineFramework);
Engine.prototype.setup=function(){};Engine.prototype.start=function(){};Engine.prototype.update=function(a){this.state.update(a)};Engine.prototype.render=function(a,b){};Engine.prototype.stop=function(){};Engine.prototype.cleanup=function(){};Engine.prototype.main=function(){};engine.mix={};function mix(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];return c.reduce(function(a,b){return b(a)},this.superclass)};engine.State={};var State=function(a){EventManager.call(this);this.name=a};$jscomp.inherits(State,EventManager);State.prototype.start=function(){};State.prototype.update=function(a){};State.prototype.render=function(a,b){};State.prototype.stop=function(){};var Demo=function(a){Engine.apply(this,arguments)};$jscomp.inherits(Demo,Engine);Demo.prototype.setup=function(){};Demo.prototype.load=function(){};Demo.prototype.update=function(a){};Demo.prototype.render=function(a){a.fillStyle="white";a.fillRect(0,0,this.canvas.width,this.canvas.height);a.fillStyle="black";a.font="20px Verdana";a.textBaseline="hanging";a.fillText(Math.round(this.fps())+"",10,10)};Demo.prototype.stop=function(){};Demo.prototype.cleanup=function(){};window.Demo=Demo;
